<!DOCTYPE html>
<html>
<head>
  <title>Buggy Tracker</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
</head>
<body>

<header>ðŸ›º Buggy Tracker</header>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyBupPnckDbBcqNOIcCGVucOfEeUd_uo22A",
  authDomain: "tracker-mit.firebaseapp.com",
  databaseURL: "https://tracker-mit-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "tracker-mit",
  storageBucket: "tracker-mit.appspot.com",
  messagingSenderId: "1055743844534",
  appId: "1:1055743844534:web:b770c413e908951f470617"
});

const db = firebase.database();

// Map
const map = L.map("map").setView([20, 78], 5);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png")
  .addTo(map);

// Buggy icon
const buggyIcon = L.icon({
  iconUrl: "https://cdn-icons-png.flaticon.com/512/854/854894.png",
  iconSize: [40, 40]
});

let marker = null;

// Listen to Firebase
db.ref("buggies/buggy1").on("value", snap => {
  const d = snap.val();
  if (!d) return;

  if (!marker) {
    marker = L.marker([d.lat, d.lng], { icon: buggyIcon }).addTo(map);
    map.setView([d.lat, d.lng], 17);
  } else {
    marker.setLatLng([d.lat, d.lng]);
  }
});
</script>

</body>
</html>
